import React, { useState } from "react";
import { View, Text, StyleSheet } from "react-native";
import Svg, { Path, Rect } from "react-native-svg";

export type BrainRegion = "frontal" | "parietal" | "temporal" | "occipital" | "cerebellum" | "brainstem";

type RegionDef = {
  id: BrainRegion;
  label: string;
  fill: string;
  highlightFill: string;
  d: string;
  tipX: number;
  tipY: number;
};

const REGIONS: RegionDef[] = [
  {
    id: "cerebellum",
    label: "Timing & Rhythm",
    fill: "#009189",
    highlightFill: "#006f69",
    tipX: 82,
    tipY: 78,
    d: "M1042.07 1047.12C1099.52 1040.96 1166.07 983.617 1170.07 980.617C1174.07 977.617 1230.57 936.617 1254.07 894.617C1277.57 852.617 1278.07 825.617 1278.07 825.617C1277.22 819.613 1278.61 800.824 1273.07 789.617C1267.53 778.409 1245.07 738.617 1237.57 735.117C1230.07 731.617 1204.07 726.617 1193.57 723.617C1183.07 720.617 1153.07 708.117 1148.07 703.617C1143.07 699.117 1139.07 720.617 1089.57 723.617C1040.07 726.617 1018.07 713.617 1018.07 713.617C1018.07 713.617 991.573 739.117 959.073 751.117C926.573 763.117 855.073 760.617 855.073 760.617C855.073 760.617 832.573 787.617 826.073 801.617C819.573 815.617 810.073 839.617 811.073 844.117C812.073 848.617 831.573 863.617 832.073 868.617C832.573 873.617 818.574 883.617 822.073 902.617C825.573 921.617 857.573 936.117 857.573 936.117L936.573 1006.12C936.573 1006.12 984.629 1053.27 1042.07 1047.12Z",
  },
  {
    id: "temporal",
    label: "Language & Meaning",
    fill: "#74A3A5",
    highlightFill: "#5a8a8c",
    tipX: 42,
    tipY: 68,
    d: "M442.23 912.434C442.23 912.434 451.23 928.434 468.23 931.934C485.23 935.434 504.73 929.934 504.73 929.934C504.73 929.934 530.73 918.434 544.23 909.434C557.73 900.434 561.73 896.934 574.23 891.934C586.73 886.934 610.73 881.934 620.23 878.934C629.73 875.934 641.23 875.434 664.73 857.434C688.23 839.434 682.73 826.934 682.73 826.934C682.73 826.934 705.73 830.434 725.23 817.934C744.73 805.434 757.73 803.434 766.23 802.434C774.73 801.434 792.73 802.434 816.23 796.434C839.73 790.434 851.73 773.434 851.73 773.434C851.73 773.434 918.517 785.132 964 764C1009.48 742.868 1021.23 715.934 1026.73 707.934C1032.23 699.934 1035.73 675.934 1035.73 675.934C1035.73 675.934 1058.23 686.934 1089.73 672.434C1121.23 657.934 1124.73 643.934 1130.73 635.434C1136.73 626.934 1139.23 594.434 1135.73 573.434C1132.23 552.434 1125.73 546.434 1118.23 536.934C1115.67 533.694 1114.23 531.531 1101.73 521.434C1089.23 511.338 1081.23 510.434 1081.23 510.434C1081.23 510.434 1081.5 487.5 1059.5 473.5C1037.5 459.5 1028.23 464.434 1015.73 464.434C1003.23 464.434 987.23 470.886 980.23 476.386C973.23 481.886 962.73 497.204 942.73 510.704C922.73 524.204 889.23 519.252 886.23 516.752C883.23 514.252 885.23 459.434 885.23 459.434L868 431.5C868 431.5 843.493 411.208 842.23 408.934C839.73 404.434 838.23 389.934 820.73 382.934C803.23 375.934 788.73 378.434 780.73 378.434C772.73 378.434 752.73 382.934 724.23 394.434C695.73 405.934 678.73 426.434 678.73 426.434C678.73 426.434 660.73 416.434 644.73 415.934C628.73 415.434 629.23 417.434 622.23 419.434C615.23 421.434 602.23 428.434 598.73 430.934C595.23 433.434 570.73 452.434 565.23 457.434C559.73 462.434 511.23 508.434 506.73 512.934C502.23 517.434 501.73 517.434 491.73 522.934C481.73 528.434 465.73 528.934 465.73 528.934C465.73 528.934 436.23 529.867 421.73 530.867C407.23 531.867 412.23 531.367 396.73 541.367C381.23 551.367 364.23 584.434 364.23 584.434L303.73 702.434C303.73 702.434 293.73 718.934 294.23 736.934C294.73 754.934 303.73 760.434 303.73 760.434C303.73 760.434 291.73 769.434 290.23 772.434C288.73 775.434 286.23 779.934 287.23 790.934C288.23 801.934 289.798 808.435 294.23 817.934C304.868 847.93 319.23 874.934 334.73 890.934C350.23 906.934 364.73 904.934 373.73 905.434C382.73 905.934 395.23 897.934 395.23 897.934C395.23 897.934 398.23 907.934 413.73 912.434C429.23 916.934 442.23 912.434 442.23 912.434Z",
  },
  {
    id: "parietal",
    label: "Attention & Spatial",
    fill: "#93DED5",
    highlightFill: "#6cc9bd",
    tipX: 52,
    tipY: 12,
    d: "M757.864 18.7545C773.958 15.4208 885.547 5.21627 900.458 15.4209C915.37 25.6256 914.458 38.9212 914.458 38.9212C914.458 38.9212 933.958 33.4214 959.958 38.9212C985.958 44.4209 999.141 60.5 999.141 60.5C999.141 60.5 1022.39 62.5016 1032.76 70.5C1042.13 77.7279 1051.54 97.5493 1053.72 102.328C1053.63 100.798 1056.21 98.393 1076.08 100.921C1103.58 104.421 1175.08 210 1176.58 215.5C1178.08 221 1128.08 294.5 1126.58 297.5C1125.08 300.5 1123.96 306.921 1123.96 306.921C1123.96 306.921 1125.46 341.421 1127.46 352.921C1129.46 364.421 1128.46 389.5 1123.96 396.5C1119.46 403.5 1104.46 412.421 1100.46 412.421H1096.46C1096.46 412.421 1096.58 435 1092.58 444C1088.58 453 1058.58 476 1058.58 476C1058.58 476 1039.08 465.5 1025.58 466.5C1012.08 467.5 1001.58 471.5 989.076 479.5C976.576 487.5 983.576 491 947.576 511.5C911.576 532 880.576 516.5 880.576 516.5C880.576 516.5 881.076 465 880.576 460.5C880.076 456 870.739 439.529 862.576 429.5C854.414 419.471 843.577 414.5 840.577 410.5C837.577 406.5 831.077 393.5 816.077 387.5C801.077 381.5 799.077 384 784.577 383.5C770.077 383 762.576 384.5 737.076 394.5C711.576 404.5 689.577 425.5 689.577 425.5L678.577 432.5C678.577 432.5 671.576 421.5 648.076 421C624.576 420.5 615.076 428.5 604.576 436C594.076 443.5 571.077 461.5 571.077 461.5C571.077 461.5 555.077 448 545.077 436C535.077 424 530.576 390 530.576 390L532.076 304C532.076 304 525.577 267 535.577 244.5C545.577 222 565.958 218.921 565.958 218.921L590.958 214.421C590.958 214.421 585.576 210 586.576 197C587.576 184 595.458 167.353 595.458 167.353C625.087 130.121 666.064 87.7581 675.458 79.3528C684.853 70.9475 741.77 22.0881 757.864 18.7545Z",
  },
  {
    id: "occipital",
    label: "Visual & Patterns",
    fill: "#347679",
    highlightFill: "#265a5c",
    tipX: 88,
    tipY: 35,
    d: "M1141 269.299L1126.5 293.799L1122.5 304.799C1122.5 304.799 1116.5 313.799 1120 329.799C1123.5 345.799 1123 352.299 1123 374.299C1123 396.299 1107 405.799 1107 405.799C1107 405.799 1102.5 409.299 1098 407.299C1093.5 405.299 1095 389.299 1091.5 389.799C1088 390.299 1092 414.299 1092 420.299C1092 426.299 1090.5 435.299 1086 444.299C1081.5 453.299 1071.5 461.299 1071.5 461.299L1053.5 474.299C1053.5 474.299 1064.5 480.299 1070.5 487.799C1076.5 495.299 1083.5 515.299 1083.5 515.299C1083.5 515.299 1088 514.299 1103.5 526.799C1119 539.299 1125.5 552.799 1125.5 552.799C1125.5 552.799 1134.5 565.799 1136 584.299C1137.5 602.799 1135.34 611.299 1135.34 611.299C1132.51 622.14 1130.92 631.564 1123 641.299C1115.08 651.034 1095.71 672.807 1065.5 672.307C1035.29 671.807 1043.24 659.203 1037 659.299C1030.76 659.396 1036.5 683.799 1026 701.799C1015.5 719.799 1015 721.799 1015 721.799C1015 721.799 1018 725.299 1029.5 728.299C1041 731.299 1055 733.799 1068 734.299C1081 734.799 1100.5 735.299 1106 734.299C1111.5 733.299 1142.5 719.799 1149 718.299C1155.5 716.799 1170.6 727.867 1181.5 734.299C1192.4 740.73 1207.54 738.735 1213 738.799C1218.46 738.863 1227.56 738.692 1242 738.799C1256.44 738.906 1284.18 728.233 1284 720.799C1283.82 713.365 1289.5 722.5 1292.5 723C1295.5 723.5 1310.5 723.299 1317 722.299C1323.5 721.299 1330.31 715.299 1333.31 712.299C1336.31 709.299 1353.02 689.961 1352 680.299C1351.57 676.206 1352.23 664.718 1352 652.799C1351.68 636.583 1347.95 623.071 1347 622.799C1345.35 622.328 1345.5 557.299 1345 551.799C1344.5 546.299 1343 539.799 1336 529.799C1329 519.799 1328.5 520.799 1327 519.299C1325.5 517.799 1326.5 490.799 1327 470.799C1327.18 463.64 1324.39 455.299 1323 451.299C1321.61 447.299 1314.24 432.004 1307.5 424.299C1304.48 420.852 1301.09 417.638 1298.5 415.299C1292.07 409.495 1287 407.299 1287 407.299C1287 407.299 1287 384.799 1286.5 382.799C1286 380.799 1277.5 352.799 1263.5 339.299C1249.5 325.799 1242.41 322.969 1241 321.799C1239.59 320.629 1237.5 300.299 1221.5 272.799C1205.5 245.299 1201 242.799 1201 242.799L1190.5 232.299C1190.5 232.299 1183 221.5 1179.5 221C1177.56 220.722 1176.64 217.798 1176 218C1175.49 218.162 1174.67 221.333 1174 222C1172.5 223.5 1170 228.299 1170 228.299C1170 228.299 1168 230.799 1165 234.799C1162 238.799 1156.5 246.799 1156.5 246.799L1141 269.299Z",
  },
  {
    id: "brainstem",
    label: "Reset",
    fill: "#A3C1C3",
    highlightFill: "#8aabae",
    tipX: 68,
    tipY: 95,
    d: "M974.06 1212.5C995.06 1208 1003.56 1200 1003.56 1200C1003.56 1200 980.56 1138 977.56 1111C974.56 1084 969.56 1027 969.56 1027C969.56 1027 923.56 998 916.06 985.5C908.56 973 857.06 934.5 857.06 934.5C857.06 934.5 850.56 933.437 837.06 919.937C823.56 906.437 837.06 878.5 837.06 878.5L830.56 872L834.56 866.5C834.56 866.5 824.06 859 821.56 849.5C819.06 840 850.56 783 850.56 783L845.06 779C845.06 779 830.56 788 827.06 790.5C823.56 793 786.06 796 781.06 797C776.06 798 763.06 798 751.56 803.5C740.06 809 732.56 813 719.06 819C705.56 825 686.56 823 686.56 823L681.56 827C681.56 827 684.075 828.15 681.56 833.5C679.045 838.85 670.56 849 668.56 852C666.56 855 670.56 860.5 670.56 860.5C670.56 860.5 691.06 888.5 704.56 898C718.06 907.5 731.06 914.874 740.56 919.937C750.06 925 771.713 931 771.713 931C781.065 944.443 800.723 971.904 810.06 979C822.56 988.5 868.06 1031.5 868.06 1031.5L933.56 1212.5C933.56 1212.5 953.06 1217 974.06 1212.5Z",
  },
  {
    id: "frontal",
    label: "Focus & Working Memory",
    fill: "#228181",
    highlightFill: "#1a6565",
    tipX: 18,
    tipY: 40,
    d: "M324 760.5C321.189 760.265 305.239 747.561 305 737C304.761 726.439 306.5 722 306.5 720C306.5 718 375.5 581.5 384 571C392.5 560.5 390 553.5 406.5 543.5C423 533.5 432 535 452 534.5C472 534 479.5 533.518 494 528.518C508.5 523.518 525 506.5 525 506.5L573.5 459.5C573.5 459.5 558 436.018 551 425.018C544 414.018 539.5 390.018 539.5 385.018C539.5 380.018 540 308 539.5 303C539 298 529.5 268 542 252C554.5 236 558 233.5 565 230.5C572 227.5 594 227 594 227L599 220.518C599 220.518 594.756 210.5 596.256 198C597.756 185.5 602 178.5 606 172C610 165.5 662.927 104.456 689.256 82L757 30.018L752.756 18.018C752.756 18.018 733.256 8.01802 721.256 5.01802C709.256 2.01802 708.756 0.518023 689.256 0.0180225C669.756 -0.481977 639.256 9.51802 626.256 18.018C613.256 26.518 614.256 25.518 602.256 30.018C590.256 34.518 584.756 27.518 580.256 27.518C575.756 27.518 575.256 32.018 570.756 33.518C566.256 35.018 561.756 28.518 531.256 30.018C500.756 31.518 486.756 39.518 486.756 39.518C486.756 39.518 473.256 47.018 469.756 47.018C466.256 47.018 448.256 45.018 434.256 47.018C420.256 49.018 409.256 53.018 394.756 61.518C380.256 70.018 366.756 88.518 366.756 88.518C366.756 88.518 345.756 88.518 329.256 95.018C312.756 101.518 301.756 110.018 292.256 117.018C282.756 124.018 258.756 149.518 258.756 149.518C258.756 149.518 250.756 146.518 237.256 149.518C223.756 152.518 200.256 172.018 200.256 172.018L170.756 197.518L134.756 226.018C134.756 226.018 128.256 231.018 122.756 239.018C117.256 247.018 110.256 276.018 110.256 276.018C110.256 276.018 94.7561 279.518 89.7561 282.018C84.7561 284.518 81.2561 282.018 71.7561 294.018C62.2561 306.018 59.2561 326.518 59.2561 326.518C59.2561 326.518 52.7561 326.518 46.2561 329.518C39.7561 332.518 36.7561 338.018 36.7561 338.018C36.7561 338.018 35.2561 340.518 33.7561 344.518C32.2561 348.518 22.2561 386.018 22.2561 396.518V407.018C22.2561 407.018 9.25614 412.518 5.25614 435.018C1.25614 457.518 8 462.5 8 462.5C8 462.5 1.75614 467.018 0.756144 485.018C-0.243856 503.018 6 510 6 512.5C6 515 2.75614 519.018 2.75614 523.518C2.75614 528.018 -1.74386 562.518 0.756144 573.018C3.25614 583.518 6.25623 591.018 11.2561 595.518C16.2561 600.018 27.5 612 31.5 613.5C35.5 615 42 616 42 616C42 616 56.4999 653 74.5 674C92.5001 695 108 710 131 719C154 728 183 735.5 183 735.5L309.244 768.982L323.5 768.5C323.5 768.5 326.811 760.735 324 760.5Z",
  }
];

type Props = {
  onRegionPress: (region: BrainRegion) => void;
  size?: number;
};

export default function BrainMap({ onRegionPress, size = 300 }: Props) {
  const [pressed, setPressed] = useState<BrainRegion | null>(null);
  const aspectRatio = 1353 / 1215;
  const width = size;
  const height = size / aspectRatio;

  return (
    <View style={[styles.container, { width, height }]}>
      <Svg width={width} height={height} viewBox="0 0 1353 1215" preserveAspectRatio="xMidYMid meet">
        <Rect width="1353" height="1215" fill="transparent" />
        {REGIONS.map((region) => (
          <Path
            key={region.id}
            d={region.d}
            fill={pressed === region.id ? region.highlightFill : region.fill}
            onPressIn={() => setPressed(region.id)}
            onPressOut={() => { setPressed(null); onRegionPress(region.id); }}
          />
        ))}
      </Svg>
      {pressed && (
        <View
          style={[styles.tooltip, {
            left: (REGIONS.find((r) => r.id === pressed)!.tipX / 100) * width - 60,
            top: (REGIONS.find((r) => r.id === pressed)!.tipY / 100) * height - 36,
          }]}
          pointerEvents="none"
        >
          <Text style={styles.tooltipText}>
            {REGIONS.find((r) => r.id === pressed)!.label}
          </Text>
        </View>
      )}
    </View>
  );
}

const styles = StyleSheet.create({
  container: { alignSelf: "center" },
  tooltip: {
    position: "absolute",
    backgroundColor: "rgba(34, 129, 129, 0.92)",
    paddingHorizontal: 12,
    paddingVertical: 8,
    borderRadius: 12,
    minWidth: 120,
    alignItems: "center",
  },
  tooltipText: { color: "#fff", fontWeight: "900", fontSize: 12 },
});
